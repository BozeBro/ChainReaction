<!DOCTYPE html><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><link href=/favicon.ico rel="shortcut icon"type=image/x-icon><link href=/static/css/index.css rel=stylesheet><link href=/static/css/waiting.css rel=stylesheet><link href=/static/css/game.css rel=stylesheet><link href=/static/css/chat.css rel=stylesheet><meta content="IE=7"http-equiv=X-UA-Compatible><meta content="Chain Reaction, Chat, Chat server, Chain Reaction Game, Chain Reaction AI, AI, Free game, online"name=keywords><meta content="Chain Reaction Game. Heroku App server. Chat server. Play or join a game with friends or with a computer. 2-25 players."name=description><meta content="Benedict Ozua"name=author><title>Chain Reaction Game - Heroku Server</title><div class=overview><div><aside><span class=navHome>CHAIN REACTION</span><div id=user-chat><div id=chat><div id=chat-messages></div></div></div><input id=chat-form name=message autocomplete=off maxlength=140 placeholder="Please be nice in chat"></aside></div><div class=general><div class=bar-wrap><canvas id=bar></canvas></div><div id=turn-display></div><div id=interface><canvas id=dynamic height=450px width=450px></canvas><canvas id=static height=450px width=450px></canvas><canvas id=grid height=450px width=450px></canvas></div></div><div><div class=noSelect><h2 id=userColor></h2></div><div>Your Pin is {{ .Pin }}</div><div>Your Room is {{ .Room }}</div><div class=noSelect id=winner></div>{{ if .Leader }}<div id=boardMatrix><label class=noSelect for=rows>Rows</label><br><input id=rows name=rows value=8><br><label class=noSelect for=columns>Columns</label><br><input id=columns name=columns value=8><br><br><button class=ent id=boardBtn>Enter</button></div>{{ end }}</div></div><div class=noSelect id=waitingRoom><div class=wait-title><h2>Chain Reaction</h2></div><div class=wait-current><div id=players>{{ .Players }}</div><div>/</div><div id=max>{{ .Max }}</div></div><div><div class=lds-roller><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><div class=ent-ext>{{if .Leader}} <button class=ent id=entBtn>Start</button> {{ end }} <button class=ext>Exit</button></div></div><script src=/static/js/chat.js></script><script src=/static/js/board.js></script><script>if(!window["WebSocket"])document.location.href=document.location.host; let goHome=document.querySelector(".navHome"); let ext=document.querySelector(".ext"); let userColor=document.getElementById("userColor");let path=document.location.pathname;letid=path.slice(path.length-8);let players=document.getElementById("players");let waiting=document.getElementById("waitingRoom");let winner=document.getElementById("winner");let wss=document.location.protocol=="https:"?"wss://":"ws://"; let socket=new WebSocket(wss+document.location.host+"/ws/"+id);let chain=new chainReaction(8,8,"red");let typing=document.getElementById("chat-form");let start=false;requestAnimationFrame((ts)=>timing(ts));typing.addEventListener("keypress",(event)=>{event.preventDefault();if(event.key!=="Enter"){typing.value+=event.key;return;} var message_element=document.getElementsByTagName("input")[0];var message=message_element.value;if(curTime-beginning<750){message_element.value="";return}else if(message.toString().length){beginning=curTime;socket.send(JSON.stringify({type:"chat",message:message,}));message_element.value="";}},false);bar.canvas.width=chain.canvas.width;bar.canvas.height=bar.canvas.width*0.05;goHome.onclick=()=>document.location.href=document.location.protocol+"//"+document.location.host;ext.onclick=()=>document.location.href=document.location.protocol+"//"+document.location.host;chain.grctx.canvas.onclick=(event)=>{if(chain.state===true&&start===true&&chain.color===chain.mycolor){let canvasObj=event.target.getBoundingClientRect();let x=Math.floor((event.clientX-canvasObj.left)/chain.squareLength);let y=Math.floor((event.clientY-canvasObj.top)/chain.squareLength);socket.send(JSON.stringify({type:"move",x:x,y:y}))}};nextAni=()=>{chain.que.shift();if(chain.que.length>0){let data=chain.que[0];chain.msgHandler[data.type.toLowerCase()](data)}};chain.msgHandler={};chain.msgHandler["chat"]=(data)=>{MessageAdd(data.message,data.username,data.color);nextAni()};chain.msgHandler["start"]=(data)=>{chain.statCtx.clearRect(0,0,chain.canvas.width,chain.canvas.height);start=true;waiting.style.display="none";winner.innerHTML="";chain.color=data.turn;chain.rows=data.rows;chain.cols=data.cols;chain.squareLength=Math.min(screen.height*.80/chain.rows,screen.height*.80/chain.cols);chain.initBoard();changeTurn(data.turn);changeBarC(data.turn);nextAni()};chain.msgHandler["move"]=(data)=>{if(data.animation.length===0){chain.draw(...data.static[0][0]);chain.color=data.turn;changeTurn(data.turn);changeBarC(data.turn);nextAni()}else if(data.static.length===0){chain.color=data.turn;changeTurn(data.turn);changeBarC(data.turn);nextAni()}else{chain.state=false;chain.draw(...data.static[0][0]);requestAnimationFrame((ts)=>chain.animate(data.animation,data.static,ts,ts,0,data.turn));}};chain.msgHandler["color"]=(data)=>{if(data.type!=="color"){return} chain.mycolor=data.color;userColor.style.color=data.color;userColor.innerHTML=`Your color is ${data.color}`;nextAni()};chain.msgHandler["update"]=(data)=>{players.innerHTML=data.players;nextAni()};chain.msgHandler["changecolor"]=(data)=>{chain.color=data.turn;changeBarC(data.turn);nextAni()};chain.msgHandler["end"]=(data)=>{console.log(`The winner is ${data.winner}`);waiting.style.display="";winner.innerHTML=`The winner is ${data.winner}!!`;winner.style.color=data.winner;nextAni()};socket.onmessage=(e)=>{let data=JSON.parse(e.data);chain.que.push(data);console.log(data);if(chain.que.length===1){chain.msgHandler[data.type.toLowerCase()](data)}};chain.initBoard();</script> {{if .Leader}} <script>let rows=document.getElementById("rows");let cols=document.getElementById("columns");let boardBtn=document.getElementById("boardBtn");boardBtn.onclick=()=>{if(start===true){return} chain.rows=rows.value!==""?Math.max(5,parseInt(rows.value)):5;chain.cols=cols.value!==""?Math.max(5,parseInt(cols.value)):5;if(chain.rows>30){chain.rows=30;rows.value="30";} if(chain.cols>30){chain.cols=30;cols.value="30";} chain.squareLength=Math.min(screen.height*.80/chain.rows,screen.height*.80/chain.cols);chain.initBoard();};let enter=document.querySelector("#entBtn");if(enter!==null&&start!==true){enter.onclick=()=>{if(parseInt(players.innerText)>=2){socket.send(JSON.stringify({type:"start",cols:chain.cols,rows:chain.rows,}));}}}</script> {{end}}</html>